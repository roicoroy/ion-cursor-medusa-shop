<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/tabs/profile"></ion-back-button>
    </ion-buttons>
    <ion-title>My Returns</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="createReturn()" fill="clear">
        <ion-icon name="add" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="ion-padding">
    <!-- Loading State -->
    <div *ngIf="loading$ | async" class="ion-text-center ion-padding">
      <ion-spinner name="crescent"></ion-spinner>
      <p>Loading returns...</p>
    </div>

    <!-- Error State -->
    <div *ngIf="error$ | async as error" class="ion-text-center ion-padding">
      <ion-icon name="alert-circle" color="danger" size="large"></ion-icon>
      <p>{{ error }}</p>
      <ion-button (click)="loadReturns()" fill="outline">
        Try Again
      </ion-button>
    </div>

    <!-- Returns List -->
    <div *ngIf="!(loading$ | async) && !(error$ | async)">
      <div *ngIf="(returns$ | async)?.length === 0" class="ion-text-center ion-padding">
        <ion-icon name="receipt-outline" size="large" color="medium"></ion-icon>
        <h3>No Returns Yet</h3>
        <p>You haven't made any returns yet.</p>
        <ion-button (click)="createReturn()" fill="outline">
          Create Return
        </ion-button>
      </div>

      <ion-list *ngIf="(returns$ | async) && (returns$ | async)!.length > 0">
        <ion-item *ngFor="let returnItem of returns$ | async" 
                  button 
                  (click)="viewReturn(returnItem)"
                  class="return-item">
          <ion-thumbnail slot="start">
                         <ion-img [src]="returnItem.items[0].item?.thumbnail || 'assets/images/placeholder-product.jpg'"
                     (ionError)="$event.target.src = 'assets/images/placeholder-product.jpg'">
            </ion-img>
          </ion-thumbnail>
          
          <ion-label>
            <h2>Return #{{ returnItem.display_id }}</h2>
            <p>{{ returnItem.items.length }} item(s)</p>
            <p *ngIf="returnItem.refund_amount">
              Refund: {{ returnItem.refund_amount | medusaCurrency }}
            </p>
            <p>{{ returnItem.created_at | date:'mediumDate' }}</p>
          </ion-label>

          <ion-badge slot="end" [color]="getStatusColor(returnItem.status)">
            {{ getStatusText(returnItem.status) }}
          </ion-badge>
        </ion-item>
      </ion-list>
    </div>
  </div>
</ion-content> 